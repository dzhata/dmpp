# modules/drivers/post_exploit/empire_api.py

import requests

def get_empire_token(api_url, username, password):
    url = api_url.rstrip("/") + "/token"
    data = {
        "grant_type": "password",
        "username": username,
        "password": password,
        "scope": "",
        "client_id": "string",
        "client_secret": "string"
    }
    headers = {
        "accept": "application/json",
        "Content-Type": "application/x-www-form-urlencoded"
    }
    resp = requests.post(url, headers=headers, data=data, timeout=10, verify=False)
    resp.raise_for_status()
    return resp.json()["access_token"]
